@page "/"
@using MCake_Manage.Data
@inject ApplicationUserController _user
@inject OrdersController _order
@inject BlogsController _blog
@inject ProductsController _product
@inject ContactsController _contact
@inject ApplicationDbContext _db




<section class="section">
    <div class="row ">
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="card">
                <div class="card-statistic-4">
                    <div class="align-items-center justify-content-between">
                        <div class="row ">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                                <div class="card-content">
                                    <h5 class="font-15">All Posts</h5>
                                    <h2 class="mb-3 font-18">@blogs.Count()</h2>
                                    <p class="mb-0"><span class="col-green">10%</span> Increase</p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                                <div class="banner-img">
                                    <img src="assets/img/banner/1.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="card">
                <div class="card-statistic-4">
                    <div class="align-items-center justify-content-between">
                        <div class="row ">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                                <div class="card-content">
                                    <h5 class="font-15"> Customers</h5>
                                    <h2 class="mb-3 font-18">@users.Count()</h2>
                                    <p class="mb-0"><span class="col-orange">09%</span> Decrease</p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                                <div class="banner-img">
                                    <img src="assets/img/banner/2.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="card">
                <div class="card-statistic-4">
                    <div class="align-items-center justify-content-between">
                        <div class="row ">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                                <div class="card-content">
                                    <h5 class="font-15">All Orders</h5>
                                    <h2 class="mb-3 font-18">@orders.Count()</h2>
                                    <p class="mb-0">
                                        <span class="col-green">18%</span>
                                        Increase
                                    </p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                                <div class="banner-img">
                                    <img src="assets/img/banner/3.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6 col-md-6 col-sm-6 col-xs-12">
            <div class="card">
                <div class="card-statistic-4">
                    <div class="align-items-center justify-content-between">
                        <div class="row ">
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pr-0 pt-3">
                                <div class="card-content">
                                    <h5 class="font-15">Revenue</h5>
                                    <h2 class="mb-3 font-18">$48,697</h2>
                                    <p class="mb-0"><span class="col-green">42%</span> Increase</p>
                                </div>
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 pl-0">
                                <div class="banner-img">
                                    <img src="assets/img/banner/4.png" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row ">
        <div class="col-xl-3 col-lg-6">
            <div class="card l-bg-green">
                <div class="card-statistic-3">
                    <div class="card-icon card-icon-large"><i class="fa fa-award"></i></div>
                    <div class="card-content">
                        <h4 class="card-title">New Orders</h4>
                        <span>@newOrders.Count()</span>
                        <p class="mb-0 text-sm">
                            <span class="mr-2"><i class="fa fa-arrow-up"></i> 10%</span>
                            <span class="text-nowrap">Since last month</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6">
            <div class="card l-bg-cyan">
                <div class="card-statistic-3">
                    <div class="card-icon card-icon-large"><i class="fa fa-briefcase"></i></div>
                    <div class="card-content">
                        <h4 class="card-title">New Products</h4>
                        <span>@newProducts.Count()</span>
                        <p class="mb-0 text-sm">
                            <span class="mr-2"><i class="fa fa-arrow-up"></i> 10%</span>
                            <span class="text-nowrap">Since last month</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6">
            <div class="card l-bg-purple">
                <div class="card-statistic-3">
                    <div class="card-icon card-icon-large"><i class="fa fa-globe"></i></div>
                    <div class="card-content">
                        <h4 class="card-title">Inquiry</h4>
                        <span>@inquires.Count()</span>
                        <p class="mb-0 text-sm">
                            <span class="mr-2"><i class="fa fa-arrow-up"></i> 10%</span>
                            <span class="text-nowrap">Since last month</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-xl-3 col-lg-6">
            <div class="card l-bg-orange">
                <div class="card-statistic-3">
                    <div class="card-icon card-icon-large"><i class="fa fa-money-bill-alt"></i></div>
                    <div class="card-content">
                        <h4 class="card-title">Earning</h4>
                        <span>@earning.Count()</span>
                        <p class="mb-0 text-sm">
                            <span class="mr-2"><i class="fa fa-arrow-up"></i> 10%</span>
                            <span class="text-nowrap">Since last month</span>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-sm-12 col-lg-12">
            <div class="card ">
                <div class="card-header">
                    <h4>Revenue chart</h4>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-9">
                            <div id="chart1"></div>
                            <div class="row mb-0">
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
                                    <div class="list-inline text-center">
                                        <div class="list-inline-item p-r-30">
                                            <i data-feather="arrow-up-circle"
                                               class="col-green"></i>
                                            <h5 class="m-b-0">$675</h5>
                                            <p class="text-muted font-14 m-b-0">Weekly Earnings</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
                                    <div class="list-inline text-center">
                                        <div class="list-inline-item p-r-30">
                                            <i data-feather="arrow-down-circle"
                                               class="col-orange"></i>
                                            <h5 class="m-b-0">$1,587</h5>
                                            <p class="text-muted font-14 m-b-0">Monthly Earnings</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
                                    <div class="list-inline text-center">
                                        <div class="list-inline-item p-r-30">
                                            <i data-feather="arrow-up-circle"
                                               class="col-green"></i>
                                            <h5 class="mb-0 m-b-0">$45,965</h5>
                                            <p class="text-muted font-14 m-b-0">Yearly Earnings</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-3">
                            <div class="row mt-5">
                                <div class="col-7 col-xl-7 mb-3">Total customers</div>
                                <div class="col-5 col-xl-5 mb-3">
                                    <span class="text-big">8,257</span>
                                    <sup class="col-green">+09%</sup>
                                </div>
                                <div class="col-7 col-xl-7 mb-3">Total Income</div>
                                <div class="col-5 col-xl-5 mb-3">
                                    <span class="text-big">$9,857</span>
                                    <sup class="text-danger">-18%</sup>
                                </div>
                                <div class="col-7 col-xl-7 mb-3">Project completed</div>
                                <div class="col-5 col-xl-5 mb-3">
                                    <span class="text-big">28</span>
                                    <sup class="col-green">+16%</sup>
                                </div>
                                <div class="col-7 col-xl-7 mb-3">Total expense</div>
                                <div class="col-5 col-xl-5 mb-3">
                                    <span class="text-big">$6,287</span>
                                    <sup class="col-green">+09%</sup>
                                </div>
                                <div class="col-7 col-xl-7 mb-3">New Customers</div>
                                <div class="col-5 col-xl-5 mb-3">
                                    <span class="text-big">684</span>
                                    <sup class="col-green">+22%</sup>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="row">
        <div class="col-md-12 col-lg-12 col-xl-12">
            <div class="card">
                <div class="card-header">
                    <h4>Top 15 Recent Payments</h4>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>Client Name</th>
                                    <th>Date</th>
                                    <th>Payment Method</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>John Doe </td>
                                    <td>11-08-2018</td>
                                    <td>NEFT</td>
                                    <td>$258</td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>
                                        Cara Stevens
                                    </td>
                                    <td>15-07-2018</td>
                                    <td>PayPal</td>
                                    <td>$125</td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>
                                        Airi Satou
                                    </td>
                                    <td>25-08-2018</td>
                                    <td>RTGS</td>
                                    <td>$287</td>
                                </tr>
                                <tr>
                                    <td>4</td>
                                    <td>
                                        Angelica Ramos
                                    </td>
                                    <td>01-05-2018</td>
                                    <td>CASH</td>
                                    <td>$170</td>
                                </tr>
                                <tr>
                                    <td>5</td>
                                    <td>
                                        Ashton Cox
                                    </td>
                                    <td>18-04-2018</td>
                                    <td>NEFT</td>
                                    <td>$970</td>
                                </tr>
                                <tr>
                                    <td>6</td>
                                    <td>
                                        John Deo
                                    </td>
                                    <td>22-11-2018</td>
                                    <td>PayPal</td>
                                    <td>$854</td>
                                </tr>
                                <tr>
                                    <td>7</td>
                                    <td>
                                        Hasan Basri
                                    </td>
                                    <td>07-09-2018</td>
                                    <td>Cash</td>
                                    <td>$128</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@code {
    public List<ApplicationUser> users = new();
    public List<Blog> blogs = new();
    public List<Order> orders = new();
    public List<Product> products = new();
    public List<int> revenue = new();
    public List<int> newOrders = new();
    public List<int> newProducts = new();
    public List<Contact> inquires = new();
    public List<int> earning = new();

    protected override async Task OnInitializedAsync()
    {
        var u = await _user.GetUser(); 
        users = u.ToList();
        var b = await _blog.GetBlogs();
        blogs = b.Value.ToList();
        orders = _db.Orders.ToList(); 
        var p = await _product.GetProducts(); 
        products = p.ToList();
        var c = await _contact.GetContacts();
        inquires = c.Value.ToList();
        var rev = orders.Select(s => int.Parse(s.TotalPrice)).ToList();
        newOrders = orders.Where(o => o.DateTime.AddDays(1) > DateTime.Now).Select(s => int.Parse(s.TotalPrice)).ToList();
        earning = orders.Where(o => o.PaymentConfirmed == true && o.DateTime.AddDays(7) < DateTime.Now).Select(s => int.Parse(s.TotalPrice)).ToList();
        newProducts = products.Where(o => DateTime.Now < o.DateTime.AddDays(2)).Select(s => int.Parse(s.Price)).ToList();

       
    }

}